#include<bits/stdc++.h>
using namespace std;
#define ll long long
#define ii pair<ll,ll>
#define lcm(a,b) (a/__gcd(a,b)*b)
#define fi first
#define se second
#define ios ios_base::sync_with_stdio(0); cin.tie(0); cout.tie(0);
#define endl '\n'
#define fopenn(tenfile) if(fopen(tenfile".in","r")){\
                            freopen (tenfile".in","r",stdin);\
                        }
const ll mod=1e9+7;
const ll base=256;
const ll N=1e6+11;
const ll LOG=21;
inline ll add(ll a,ll b){
    return ((a%mod + b%mod)%mod + mod)%mod;
}
inline ll mul(ll a,ll b){
    return ((a%mod) * (b%mod) + mod)%mod;
}
inline ll sub(ll a,ll b){
    return ((a%mod - b%mod)%mod + mod)%mod;
}
string s;
unordered_map<ll,ll> mp;
void solve(){
    ll res=1e18, n;
    cin>>n>>s;
    mp.clear();
    ll l=0,d=0.;
    for(ll i=0;i<s.size();i++){
        if(mp[s[i]-'a']==0){
            d++;
        }
        mp[s[i]-'a']++;
        while(d>=26){
            if(d==26){
                res=min(res,i-l+1);
            }
            mp[s[l]-'a']--;
            if(mp[s[l]-'a']==0 || mp[s[i]-'a'] == 0){
                d--;
            }
            l++;
        }
        
    }
    cout<<res << endl;
}
signed main(){
    ios;
    fopenn("collectingofficer");
    ll tt=1; cin>>tt;
    while(tt--){
        solve();
    }
}
/*

....................................#..............................%.......:-::*.*-...................
.----------------------------...+@*...----..:@@@@-:--:%@@*.:-----:...@@...@@%%@.@@@..---------------.
.--------------------------...@@...-----::.@=:...:---:...:@-:-------:..-@@@%%@.@@@:.---------------.
.------------------------...@-..:------:.%:..:-----------:::#.:--------..@@%%@@.@@@..:--------------.
.----------------------...@-..--------::@.:-----------------:@::-----....@#%%@.@@@@.......:---------.
.--------------------:..@@..----------.%.:------------------:.@.:----.@..@@%@@@.@@@+@@@@@+....-------.
.-------------------..+@..:----------=+::--------------------:.#::---.@@@@%@@@@@@**@@%@@@@@...:-----.
.-----------------:..@.:-----------:=-----:-:-----------------:.@.:--..:@@@@@@..@@@@@%%%@@@@.....--.
.----------------..+@..=---------:.#-------%-------------------:.@.:--..@@@:.@..@@@@@@@@%*=-@@@....-.
.--------------...@-.-=-=---==---:%-:------::-------------------:.%.-=+..@@@@@@......=:*%@@@@@@@@@:-.
.------------...@..:=-----=-.:--:-+:-----:-:--------------------=-.@=..:..@@%@@.@@@=@@@%%%@@.....-.
.----------...@...-+--==--=.-==:-+-------.@.-----------------==-==--:......@@@%@@...@@@%%@@@...----.
.--------...@...=:@:-===-====--:@.:::=---.@.====-------==-:::---..--@-=:==..@@@@@...@=@#@@@@@..:-----.
.-------..@#..:..@.:----=-==--:%..-:-=:=:.@.-::====-=-=.=-.@.-===.--:+-=-=-....=@@@@@.%@@-:...:------.
.------..@..-:@@@:-=-------==:#:.::.=:.=.%.::-::+.::@:-.:-.@.:--====-%--=====-..@@@@@@@.@@@@..-------.
.----:..@..*@..=.:-=-=-=----:.#-=::--::..@.:.::.+-::*:====.@%.-==--=-.+--======..@@%%@@#.@@@.-------.
.----..@.*@...@-====-====---.%.-=--*%*..@:@.=--====--.:-=-.+.*.:==:...#:=======-..@@@@%@@.@@.:------.
.---..@.@.....%:----==-=-==:*@:-..@...:@@@@.=======-:@:--.-@@@@.::+@@@*=-=====+**:..@@@@@@@@@..------.
.---.*.@..--.@:=--+=-===-==.@....@#..%@=..*..=--===-:.-:::@...-@@......#:=-==-=-..-%=....@*@@@..:----.
.---.@@..--..*:-.@-=======-.@...@@..@##+#.@@.-:::====:@..@..%@#.*@@.:-:%:+===+++:-:+-.@*..@..*@-:----.
.---.+..---.@:-:@::--=====..#.@@..:=@:.....#=.:@.:===:#=-@.:......*@=..@.=-*-===--=#%:::%..@....:----.
.---:::---:.@.:@.-====--==.@@+....@........%@+.*@..---.@@...........@%-@.-:#-==++==---%:.@.=@.-------.
.---------.::.@:====--#-=-.@.@@@@@@@@@@@....=@@.%@...:.++...@@@@@@@@@@...**+-==-=-==#:%=.@.%@.:------.
.---------.@-#=-=::--:%:-..@@@@..@@@@%@@@@@..:%@@.@@@*:.+@@@@@@@@@@@@@@@@.*.===-%-==-=-=.@.#@.-------.
.--------..@.--=-.@+-:@..:*@@...@@%+#+%@....:..#:..=@.@@@@.@@@%#%#@...@+%=@.-==:#:==-@-=.@..@.:------.
.-------..@.@:=-.@@.=--.@@@@....@@*##*#@:.----...:.........@#+##*#@@..:.@@@%--=.@.===:#--:@...-------.
.------..@-=.:-.@@+.==:@....@+...@@@@@@@..---------------..@@@#@%@@..#%.@@@:+=:.@.-==-#:=-=@..-------.
.----...@+.#:=+%@.:-==.@-..@.=@..+@@@@@..-----------------.@@@@@@@..@.@-..+.-=:@@*.===-@===*@..------.
.--:..%+=+-@:+@..:+===.+@-.@...:........------------------.....@..%.......*-=-.:+@.-==-*-===*@..-----.
.--:=@%@@.@.*..@:+-==:.-.%*@=----------..................---......:---..#*---@:#+@:==:=..-=-=@...---.
.---*=.....@=@..@.@:-=:%@@:..::--------:.@@@@@@@@@@@@@@@@.-----------:..@::.@+==@:#.:=-@@@+....*@.:--.
.--:..::--.-%-.+=.*+.-.:.+..:----------:.@%*@@@@@@@@@%@@@.-----------:%@+#@=*.*#..=@.-:#...@@@@@@.---.
.---------:.=-.@=.#@..+@#@@..----------:.@@@@-=+%=++=.@@@.-----------:.....@@.=..@@@*.=#.:........:--.
.----------...@=:.#@@.-=@@%@..:---------..@+.::-::--:.@...-----------:..@@....@@@%**@.@..------------.
.---------:.@@=.:@@##-+%@*-@@...:-------..@:=+=%=+++=#...----------:..#@.@@@@@#****+@=@..------------.
.---------.:+-:@@.#%-:@+..=*@*@*....:---..@-++=@=+++-@.:--------....*@::.@###****#*+@.#=.------------.
.---------.@.-@.#.@%:.@@@@+#@..-:@%......-#++++%=++=#@.---.......+@@.:::.@-=@%**+%+*%-.@.------------.
.---------.@.@..@-@@@.++=:%@..=..@@@@@@@@@++++**++++%......=@@@@@+%@.==.%@%*+#**#@.#.:-----------.
.---------.@@..+-.@:.@..@@@..-..@%#@@....@=++=#=++++@@+@=@+.@@@@@@@..-:.@*%@..@*%-#*@:#..-----------.
.---------.....@=.@..@@@@@..-..@@*@#.....@+++=#=++++#..%:@.@@@@@.@..--.#%++@@.@**%:@@%#.@.-----------.
.---------:::-..@@...@@@+.:-..@@@@*.@@@..==++=#=++++@#@..:+.....@..--..@@%*@.-@%#@..@@@.@.-----------.
.--------------..@.-..@..:::+@....*.@=@@@@:++=%=+++:%...@@@@@@@@*.-=..@..@@+:@.@@@...@@.@.-----------.
.---------------...-...:-==@.@...@@@@@.*@@.++=#++++.@@@@@#*@-=*..:-:.@@@..@....@@..:..@:@.-----------.
.------------------..@:+=*%..@-.%@@@%@..+@.+++#=+++.@@@@.@@%@+@.:=-..@%@....--....--:.@@..-----------.
.------------------.%-:@*..:-.@.@@@@@@@..@-+++*++++.@%*.@::%@@@..*-.@@@%.................------------.
.------------------.@+@...=+....*#.@@....@=++++++++.@++@:@@%-...==..@@*...@@%@%@%@@+@*%@.------------.
.------------------.@@.:-:--:..#-@@@@@@@.=-+++*+++=.@@##@@*@*@@.@@..=@..%.:::-::.-@:#.+-:------------.
.------------------..:.::++#=*::..-@@@+@@@.+++*+++=.@.@@##*@**@@:-#+@..#.@.....:.-.:-.-=:------------.
.-------------------::--::.....-::......@@.**+++++-.#@@*#%#@#+@:@@.#@..+:-------::::::::-------------.
.--------------------------.@#==+-=+.:...@.=++++++::@###%#@@@@@@@@@@@:.-@.:--------------------------.
.--------------------------.@.:+.........@@:*+++++.#@@@@@@@............+.:---------------------------.
.-------------------------:..+#..:+@=.#*.-@-++++++:@#......*@@@@@@@@%@@..----------------------------.
.-------------------------:-..@-.@%#@:..@.#++++++:#....*.@.........@@@.....-------------------------.
.--------------------------@#..@.....:@@@:.%-++++-@:=%@#+.@......:+...@@#:...------------------------.
.-------------------------:....%.......@.@@@#++=+#@@@@@@+.@.+@@-...:.@@@@@@@.------------------------.
..............................*@@@*@@@@..................%@@....@.....................................
*/
